<!-- TITLE: permissions -->
<!-- SUBTITLE: описание модуля permissions -->

# `permissions` - модуль для создания различных разрешений и настроек для пользователей и групп, и контроля их исполнения

а налог стандартного `permissionEx` для плагинов  написанных под `ScriptCraft` и еще немно плюшек

Данный модуль содержит в себе основные функции для проверки предустановленных в файлах концигурации разрещений и получения заданных тамже параметров для плагинов.
По сути не в полной мере дублирует функционал плагина PermissionEx. Разработана из-за невозможности получить доступ к данным PermissionEx.
В целях ускорения работы при первом вызове, модуль загружает данные из файлов конфигурации и разворативает их в удобный для машинной обработки формат.

## Файлы конфигурации:

- - minecraft_server_folder/scriptcraft/data/config/modules/last/permissions/groups.json - настройки групп пользователей.
- minecraft_server_folder/scriptcraft/data/config/modules/last/permissions/users.json - индивидуальные настройки пользователей.

## секции и параметры фала конфигурации групп:

- isEnable [true|false] - если установленно в false, модуль игнорирует эту группу как будто ее нет в файле коныигурации.
- priotity [number] - выжный параметр указывающий приоритет группы. Если пользователь является членом двух или более групп и все они или некоторые из них содержат одинаковые названия разрешений и/или параметров но с разными значениями установленными для них, модуль будет использовать значения из группы с наивысшим приоритетом. Так же следует отметить, что наивысшим приоритетом обладают разрешения и параметры указанные в персональных настройках пользователя.
- default - [true|false] - если установленно в true, то разрешения и параметры этой группы будут использоватся по умолчанию если запрашиваемое значение или параметр не описан ни в одной из групп, членом которых является пользователь. Такое поведение гарантируется даже если параметр isEnable для дефолтной группы выставлен в false.
- permissions - секция содержит разрешения для различных плагинов. смотрите примеры использования.
- options - секция содержит параметры для различных плагинов. смотрите примеры использования.

**Пример:**
```javascript
...
"guest": {							// описание группы "guest"
	"isEnable": true,					// группа включена
	"default": true, 					// группа по умолчанию
	"priotity": 10,						// приоритет группы
	"permissions": {					// разрешения группы
		"last_warp.warp": false         
	},
	"options": {						// параметры группы
		"last_warp.max":0,
		"last_teleport.cost": 300
	}
},
"player": {							// описание группы "player"
	"isEnable": true,					// группа включена
	"priotity": 20,						// приоритет группы
	"permissions": {					// разрешения группы
		"last_elitra.slap": false,  	// разрешение отключено, как если бы его вообще небыло
		//"last_spawn.spawn": true,		// разрешение отключено, как если бы его вообще небыло
		"last_spawn.sign.use": true,
		"last_spawn.sign.place": true,
		"last_warp.sign.use": true,
		"last_warp.sign.place": true,
		"last_warp.access": true,
	},
	"options": {						// параметры группы
		"last_warp.max":0,
		"last_teleport.cost": 300
	}
},
...
```

## секции и параметры фала конфигурации пользователей:
- name - содержит никнэйм игрока
- groups - секция содержит названия групп членом которых является пользователь
- permissions - секция содержит разрешения для различных плагинов. смотрите примеры использования
- options - секция содержит параметры для различных плагинов. смотрите примеры использования

**Пример:**
```javascript
...
"2f8a6ef2-e971-4b9a-90b9-f54db65dc4b7":{
	"name": "Serrgy",
	"groups": {
		"player": true,
		"vip": true
	},
	"permissions":{
			// тут можно задать персональные разрешения для игрока
	},
	"options": {
		// тут можно задать персональные настройки для игрока
	}
},
...
```

## API:

***`getUserPermissions(user)` -  возвращает объект класса `UserPermission`, содержащий разрешения и параметры пользователя (групповые и индивидуальные), а также функции их проверки и получения***
 * @param  {object} `user` объект, содержащий данные пользователя
 * @return {object}      возвращает объект класса `UserPermission`, содержащий разрешения и параметры пользователя (групповые и индивидуальные), а также функции их проверки и получения
 
***`isPermission(permissionName)` - метод класса `UserPermission`. Возвращает `true` если для указанного пользователя установленно разрешение с именем `permissionName`, иначе возвращает `false`***
 * @param {string}         `permissionName` строка, содержащая название проверяемого разрешения. Например: `last_warp.sign.use`
 * @return {boolean}      возвращает `true` если для указанного пользователя установленно разрешение с именем `permissionName`, иначе возвращает `false`

***`getParam(paramName)` - метод класса `UserPermission`. Возвращает актуальное для пользователя, значение параметра `paramName`***
 * @param {string}         `paramName` строка, содержащая название получаемого параметра. Например: `last_warp.max`
 * @return {boolean}      возвращает актуальное для пользователя, значение параметра `paramName`
 
 ***`isGroup(groupName)` - метод класса `UserPermission`. Возвращает `true` если указанный пользователь является членом группы `groupName`, иначе возвращает `false`***
 * @param {string}         `groupName` строка, содержащая название проверяемой группы
 * @return {boolean}      возвращает `true` если указанный пользователь является членом группы `groupName`, иначе возвращает `false`
 
 ## Примеры использования:

## Зависимости:
 
 - utils - стандартный модуль ScriptCraft
