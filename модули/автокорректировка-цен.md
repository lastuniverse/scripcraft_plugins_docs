<!-- TITLE: Автокорректировка цен -->
<!-- SUBTITLE: Описание модуля автокорректировки цен -->

# Автокорректировка цен

### требования к авторегулированию:
1. цена на товар считается сбалансированной если число покупок и число продаж за контролируемый период примерно равны
2. на начальном этапе использования нового товара (или товара для которого ранее не было торговых операций) должен произойти быстрый рост цен на товар до порога выравнивания покупок и продаж.
3. контролируемый период должен быть достаточно длинным для того чтобы усложнить махинации ценами, но при этом достаточно коротким чтобы обеспечить быстрое вхождение цены в сбалансированное стстояние

### математика:

**1. для каждого отдельно взятого уникального товара сервер в течении суток запоминает количество купленного/проданного товара.**

**2. в конце суток, во время перезагрузки, для каждого вида товара вычисляется суммы количества купленного и проданного за расчетный период:**

`buy_N = ...` - количество вида товара купленное за расчетный период

`sell_N = ...` - количество вида товара проданное за расчетный период

**3. затем вычисляется корректировочный коэффициент цены для каждого вида товаров**

`Q = (sell_N + fake) / (buy_N  + fake)`

где:
- `fake` - количество фиктивных покупок/продаж, чем больше, тем менее заметно влияние в изменении фактических покупок/продаж

если продаж больше чем покупок то `Q > 1`

если продаж меньше чем покупок то `Q < 1`

**3. производится пересчет цены для кажрого вида товара**

`new_cost = cost + ((cost/regress)*Q)`

где:
- `regress` - коэффициент уменьшающий влияние коэффициента `Q` на формирование новой цены (предположительно равен `10`). тоесть если `Q = 1` или `Q = -1` то цена увеличится не более чем на `1/regress` от текущей цены
- `cost` - текущая цена товара
- `new_cost` - новая цена товара

